<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Hoodie or Nah</title>
  <meta name="description" content="Settle the hoodie debate. Hoodie, maybe, or nah based on your local weather." />
  <meta name="theme-color" content="#0b0b0f" />

  <link rel="icon" href="/favicon.ico" sizes="any" />
  <link rel="icon" type="image/png" href="/favicon-32.png" sizes="32x32" />
  <link rel="icon" type="image/png" href="/favicon-16.png" sizes="16x16" />
  <link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180" />
  <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192" />
  <link rel="icon" type="image/png" href="/android-chrome-512x512.png" sizes="512x512" />

  <style>
    :root {
      color-scheme: dark;
      --bg:#0b0b0f;
      --text:#f4f4f6;
      --muted:#b9b9c2;
      --border:rgba(255,255,255,.12);
      --radius:22px;
      --shadow:0 14px 30px rgba(0,0,0,.35);
    }

    * { box-sizing:border-box; }

    body {
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background: radial-gradient(900px 600px at 50% -20%, rgba(120,100,255,.12), transparent 60%), var(--bg);
      color:var(--text);
      min-height:100vh;
      display:flex;
      justify-content:center;
      padding:18px;
    }

    .wrap { width:min(860px, 100%); }

    header {
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:14px;
    }

    .brand {
      display:flex;
      gap:12px;
      align-items:center;
      font-weight:800;
      font-size:20px;
    }

    .brand img {
      width:38px;
      height:38px;
      border-radius:999px;
    }

    .pill {
      display:flex;
      gap:6px;
      align-items:center;
      border:1px solid var(--border);
      border-radius:999px;
      padding:8px 12px;
      font-size:13px;
      color:var(--muted);
      background:rgba(255,255,255,.05);
      cursor:pointer;
      max-width:60%;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .card {
      border:1px solid var(--border);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:20px;
      background:rgba(255,255,255,.04);
    }

    .hero {
      display:grid;
      grid-template-columns:1.25fr .75fr;
      gap:18px;
    }

    @media (max-width:800px) {
      .hero { grid-template-columns:1fr; }
    }

    .answerBox {
      border:1px solid var(--border);
      border-radius:var(--radius);
      padding:20px;
      min-height:260px;
      background:rgba(0,0,0,.25);
    }

    .answer {
      font-size:72px;
      font-weight:900;
      margin:0 0 8px;
      letter-spacing:.5px;
    }

    .reason {
      font-size:16px;
      color:var(--muted);
      max-width:46ch;
      line-height:1.45;
    }

    .meta {
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:14px;
      font-size:13px;
      color:var(--muted);
    }

    .meta span {
      border:1px solid var(--border);
      padding:6px 10px;
      border-radius:999px;
      background:rgba(255,255,255,.03);
    }

    .controls {
      border:1px solid var(--border);
      border-radius:var(--radius);
      padding:18px;
      background:rgba(0,0,0,.25);
      display:flex;
      flex-direction:column;
      gap:12px;
    }

    label {
      font-size:13px;
      color:var(--muted);
    }

    select, input {
      width:100%;
      padding:12px;
      border-radius:14px;
      border:1px solid var(--border);
      background:rgba(255,255,255,.04);
      color:var(--text);
    }

    button {
      padding:10px 14px;
      border-radius:14px;
      border:1px solid var(--border);
      background:rgba(255,255,255,.06);
      color:var(--text);
      cursor:pointer;
      font-weight:600;
    }

    footer {
      margin-top:14px;
      font-size:13px;
      color:var(--muted);
      display:flex;
      justify-content:space-between;
      align-items:center;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <img src="/logo-mark.png" alt="Hoodie or Nah">
        Hoodie or Nah
      </div>
      <div class="pill" id="locPill">Near you</div>
    </header>

    <main class="card">
      <section class="hero">
        <div class="answerBox">
          <div class="answer" id="answer">‚Ä¶</div>
          <div class="reason" id="reason">Loading weather.</div>
          <div class="meta" id="meta"></div>
        </div>

        <div class="controls">
          <label>How do you run?</label>
          <select id="tempPref">
            <option value="0">Normal</option>
            <option value="-4">I run cold</option>
            <option value="4">I run warm</option>
          </select>

          <label>Manual location (optional)</label>
          <input id="city" placeholder="City or ZIP" />
          <button id="useCity">Use this location</button>
          <button id="useGps">Use my GPS</button>
        </div>
      </section>
    </main>

    <footer>
      <div>Made to settle the daily hoodie debate.</div>
    </footer>
  </div>

<script>
const locPill = document.getElementById("locPill");
const answerEl = document.getElementById("answer");
const reasonEl = document.getElementById("reason");
const metaEl = document.getElementById("meta");

let state = { lat:null, lon:null, label:"Your area" };

function setPill(label) {
  locPill.textContent = label ? "üìç " + label : "Near you";
}

async function reverseGeocode(lat, lon) {
  try {
    const r = await fetch(
      `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}`
    );
    const d = await r.json();
    if (d.address) {
      const city = d.address.city || d.address.town || d.address.village;
      const state = d.address.state || d.address.region;
      if (city && state) return city + ", " + state;
      if (city) return city;
    }
  } catch {}
  return "Your area";
}

async function fetchWeather(lat, lon) {
  const r = await fetch(
    `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=apparent_temperature,wind_speed_10m&temperature_unit=fahrenheit`
  );
  return r.json();
}

async function run() {
  const w = await fetchWeather(state.lat, state.lon);
  const feels = Math.round(w.current.apparent_temperature);
  const wind = Math.round(w.current.wind_speed_10m);

  answerEl.textContent = feels < 62 ? "HOODIE" : feels < 68 ? "MAYBE" : "NAH";
  reasonEl.textContent = `It feels like ${feels}¬∞F in ${state.label}.`;
  metaEl.innerHTML = `
    <span>Feels like ${feels}¬∞F</span>
    <span>Wind ${wind} mph</span>
  `;
}

async function useGps() {
  navigator.geolocation.getCurrentPosition(async pos => {
    state.lat = pos.coords.latitude;
    state.lon = pos.coords.longitude;
    state.label = await reverseGeocode(state.lat, state.lon);
    setPill(state.label);
    run();
  });
}

document.getElementById("useGps").onclick = useGps;
document.getElementById("locPill").onclick = useGps;

useGps();
</script>
</body>
</html>
