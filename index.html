<!-- PATCH 1: Logo bigger (drop into your <style> section, replacing the existing .brand-btn and .brand-btn img blocks) -->
<style>
  .brand-btn{
    width: 68px;
    height: 68px;
    border-radius: 999px;
    border: 1px solid var(--border2);
    background: radial-gradient(circle at 30% 25%, rgba(255,255,255,.10), rgba(255,255,255,.02));
    display:grid;
    place-items:center;
    padding:0;
    cursor:pointer;
    transition: transform .18s ease, box-shadow .18s ease, border-color .18s ease;
    box-shadow: 0 8px 28px rgba(0,0,0,.45);
    overflow:hidden;
  }
  .brand-btn:hover{
    transform: translateY(-1px);
    border-color: rgba(140,170,255,.35);
    box-shadow: 0 10px 34px rgba(0,0,0,.55), 0 0 26px rgba(120,160,255,.14);
  }
  .brand-btn:active{transform: translateY(0px) scale(.99)}
  .brand-btn img{
    width: 56px;
    height: 56px;
    display:block;
    image-rendering: auto;
    filter: drop-shadow(0 10px 18px rgba(0,0,0,.55));
    border-radius: 14px;
  }
</style>

<script>
/* PATCH 2: Stop "nothing loads" regressions
   Paste this into your <script> section:
   1) Replace your current applyFrozenFromUrl() function with this version
   2) Add/replace the event listener hookups with the "SAFE HOOKUPS" block below
*/

/* Replace applyFrozenFromUrl() with this */
function applyFrozenFromUrl(){
  const params = new URLSearchParams(window.location.search);
  const frozen = params.get("frozen") === "1";
  if (!frozen) return false;

  const loc = params.get("loc") || "Somewhere";
  const units = (params.get("units") || "F").toUpperCase() === "C" ? "C" : "F";
  const run = params.get("run") || "normal";

  const temp = parseFloat(params.get("temp"));
  const feels = parseFloat(params.get("feels"));
  const wind = parseFloat(params.get("wind"));

  /* Critical guard: bad frozen URLs should fall back to live mode */
  if (!Number.isFinite(temp) || !Number.isFinite(feels) || !Number.isFinite(wind)) {
    return false;
  }

  const verdict = params.get("verdict") || "MAYBE";
  const snark = params.get("snark") || "This take has been frozen in time.";

  state.placeLabel = loc;
  state.units = units;
  state.run = (run === "cold" || run === "hot" || run === "normal") ? run : "normal";
  state.source = "frozen";
  state.lastDecision = { word: verdict, line: snark };

  const lat = parseFloat(params.get("lat"));
  const lon = parseFloat(params.get("lon"));
  state.lat = Number.isFinite(lat) ? lat : null;
  state.lon = Number.isFinite(lon) ? lon : null;

  setFrozenUI(true, { pop: false });

  if (runSelect) runSelect.value = state.run;

  renderResult(temp, feels, wind);

  if (locLine) locLine.textContent = state.placeLabel;
  if (locSource) locSource.textContent = "Source: Frozen.";
  if (unitsLine) unitsLine.textContent = "Units: " + (state.units === "F" ? "Fahrenheit" : "Celsius");

  return true;
}

/* SAFE HOOKUPS: replace your event listener section with this */
(function wireEventsSafely(){
  if (runSelect){
    runSelect.addEventListener("change", () => {
      if (state.frozen){
        showToast("Too late. The verdict has spoken.");
        runSelect.value = state.run;
        return;
      }
      state.run = runSelect.value;
      if (Number.isFinite(state.last.temp) && Number.isFinite(state.last.feels) && Number.isFinite(state.last.wind)){
        state.lastDecision = decide(
          state.units === "F" ? state.last.temp : toF(state.last.temp),
          state.units === "F" ? state.last.feels : toF(state.last.feels),
          state.run
        );
        renderResult(state.last.temp, state.last.feels, state.last.wind);
      }
    });
  }

  if (manualInput){
    manualInput.addEventListener("input", () => {
      if (state.frozen) return;
      suggestLocations(manualInput.value).catch(() => {});
    });

    manualInput.addEventListener("keydown", (e) => {
      if (e.key === "Enter"){
        e.preventDefault();
        if (state.frozen){
          showToast("Too late. The verdict has spoken.");
          return;
        }
        onManualCommit();
      }
    });
  }

  if (spinBtn) spinBtn.addEventListener("click", onSpinGlobe);
  if (gpsBtn) gpsBtn.addEventListener("click", onUseGPS);

  if (brandHome){
    brandHome.addEventListener("click", () => {
      if (state.frozen){
        showToast("This page is frozen. Copy the link, then keep going.");
        return;
      }
      if (manualInput) manualInput.value = "";
      if (locList) locList.innerHTML = "";
      tryAutoLocation();
    });
  }

  if (freezeBtn){
    freezeBtn.addEventListener("click", async () => {
      if (state.frozen){
        showToast("Too late. The verdict has spoken.");
        return;
      }
      const url = encodeFrozenUrl();
      if (!url){
        showToast("Need a real verdict first. Give it a second.");
        return;
      }

      const ok = await copyToClipboard(url);
      if (ok) showToast("Judgment frozen. No take-backs.");
      else showToast("Could not copy link. Your browser is being difficult.");

      window.history.replaceState(null, "", url);
      setFrozenUI(true, { pop: true });
    });
  }

  if (copyLinkBtn){
    copyLinkBtn.addEventListener("click", async () => {
      const url = encodeFrozenUrl() || window.location.href;
      const ok = await copyToClipboard(url);
      if (ok) showToast("Link copied. Go start arguments.");
      else showToast("Could not copy link. Your browser is being difficult.");

      /* Unfreeze on copy */
      clearFrozenUrl();
      state.source = "manual";
      setFrozenUI(false, { pop: false });
    });
  }
})();

/* Init stays the same, but make sure it looks like this */
(function init(){
  state.run = runSelect ? runSelect.value : "normal";

  const isFrozen = applyFrozenFromUrl();
  if (isFrozen) return;

  updateSourceUI();
  tryAutoLocation();
})();
</script>
